---
title: "Homework 11"
author: "Daniel Crofts"
format: pdf
editor: visual
---

## MLE 1

![]("MLE1.jpg")

## Data and Libraries

```{r}
library(tidyverse)
library(maxLik)


conif <- read_csv(file="0.104371977
0.053104072
0.305166493
0.310379228
0.32092772
0.208851225
0.277968202
0.10871746
0.04564774
0.086263
0.626869326
0.490029515
0.408826361
0.168965039
0.30313289
0.418034601
0.025385607
0.602923157
0.254838309
0.170198755
0.4392535
0.108287265
0.077281059
0.538612218
0.085307406
0.170186726
0.148844051
0.91359885
0.275929075
0.371463238
0.496603462
0.539099327
0.335613216
0.416168829
0.915714893
0.519294518
0.70632480499999994
0.754536587
0.967873915
0.289756917
0.670459242
0.208301639
0.094256167
0.188373825
0.415619335
0.253357968
0.11487603
0.898686459
0.18673118
0.598712685
0.566928949
0.705662752
0.791998746
0.745841679
0.530192668
0.045220046
0.345684712
0.400185256
0.162893423
0.062363681
0.167460063
0.369084159
0.177063591
0.176830347
0.276505732
0.094505719
0.40327007
0.555597977
0.411525227
0.478775433
0.289643625
0.146967618
0.475353241
0.825641294
0.588138081
0.491033305
0.653743232
0.055795584
0.182118447
0.078304506
0.247584297
0.612978298
0.230847057
0.00771773
0.152403134
0.764961615
0.291982351
0.37880734
0.263376487
0.327035849
0.517103942
0.59194142
0.943577942
0.616066154
0.840931619
0.58937555
0.920830502
0.855984382
0.228130039
0.134130013
0.217622347
0.6795432
0.592045786
0.317321338
0.726297606
0.104357886
0.877530718
0.542638919
0.694288187
0.270038718
0.917140658
0.619101191
0.056080492
0.22685473
0.23777234",
col_names = "x")

conifavg <- conif$x
```

## Find MLEs for alpha and beta

```{r}
fx <- function(x){
  -x^4 + 4*x^3 - 2*x^2
}

optimize(fx, interval=c(-2, 4), maximum=TRUE)


#create function for beta density
loglik <- function(theta,x){
  if (any(theta<=0))
    NA
  else
    dbeta(x, theta[1], theta[2], log=TRUE)
}

#find MLEs
ml <- maxLik(loglik, 
             start=c(shape1=.5, shape2=.5),
             x=conifavg)
ml

#label resulting MLEs
alpha.hat <- coef(ml)[1]
beta.hat <- coef(ml)[2]

#plot histogram with estimated density
betadens <- tibble(x=seq(0,1, length=1000), 
                   y=dbeta(x, shape1=alpha.hat, shape2=beta.hat))
ggplot(conif, aes(x=x)) +
  geom_histogram(aes(y = ..density..), bins = 30, fill="gray80") +
  geom_line(data = betadens, aes(x=x, y=y), color="red", linewidth = 1.1)

#check agreement of sample mean and mean of estimated density
# mean(conifavg)
# alpha.hat/(alpha.hat+beta.hat)

alpha.hat
beta.hat
```